# 数据库设计规范

## 1. Prisma 规范
- **模型命名**：
    - Model 名称使用 **PascalCase** (单数)，如 `User`, `Application`。
    - 字段名称使用 **camelCase**，如 `createdAt`, `firstName`。
- **字段规范**：
    - **主键**：统一使用 CUID (`id String @id @default(cuid())`)。
    - **时间戳**：所有核心业务表必须包含 `createdAt` 和 `updatedAt`。
    - **状态字段**：使用 String 类型存储枚举值（如 `status`），避免使用 Int 魔法数字。建议在应用层定义常量或 Enum。
    - **JSON 字段**：对于非结构化配置（如 OIDC 的 `redirectUris`），可使用 String 存储 JSON 字符串（SQLite 限制）或 JSON 类型（如数据库支持）。

## 2. 数据库操作
- **安全**：
    - 严禁在 Client Component 中直接导入 `prisma` 实例。
    - 查询时注意过滤敏感字段（如 `password`, `clientSecret`），除非业务逻辑明确需要。
- **环境**：
    - 开发环境使用 SQLite (`dev.db`)。
    - 生产环境可能迁移至 MySQL/PostgreSQL，编写 Schema 时应尽量保持兼容性（避免过度依赖特定数据库特性）。

## 3. 变更管理
- 每次修改 `schema.prisma` 后，必须运行 `pnpm prisma migrate dev` (或 `db push`) 更新数据库结构，并重新生成 Client。
- 关键变更应记录在 `docs/specs/` 下的数据库文档中。
